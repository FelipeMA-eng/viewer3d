<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Visualizador 3D</title>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <style>
      html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        width: 100%;
        overflow: hidden;
        background: #000;
      }

      model-viewer {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        touch-action: pan-y;
      }
    </style>
  </head>
  <body>
    <model-viewer
      id="viewer"
      camera-controls
      background-color="#ffffff"
      shadow-intensity="0.5"
      exposure="1"
      environment-image="neutral"
      ar>
    </model-viewer>

    <script>
  const params = new URLSearchParams(window.location.search);
  const modelo = params.get("modelo");
  const comando = params.get("comando");

  const viewer = document.getElementById("viewer");

  const baseURL = "https://pfhelkhdgshsiclszfxh.supabase.co/storage/v1/object/public/";
  if (modelo) {
    viewer.setAttribute("src", baseURL + modelo);
  } else {
    viewer.setAttribute("src", baseURL + "model3d/modern_house_of_shapes.glb");
  }

  window.addEventListener("message", async (event) => {
  const comando = event.data;
  const viewer = document.getElementById("viewer");
  const orbit = await viewer.getCameraOrbit();

  if (comando === "zoomIn") {
    const novoZoom = Math.max(orbit.radius - 1, 0.5);
    viewer.cameraOrbit = `${orbit.theta}rad ${orbit.phi}rad ${novoZoom}m`;
  } else if (comando === "zoomOut") {
    const novoZoom = orbit.radius + 1;
    viewer.cameraOrbit = `${orbit.theta}rad ${orbit.phi}rad ${novoZoom}m`;
  } else if (comando === "rotateLeft") {
    viewer.cameraOrbit = `${orbit.theta - 0.3}rad ${orbit.phi}rad ${orbit.radius}m`;
  } else if (comando === "rotateRight") {
    viewer.cameraOrbit = `${orbit.theta + 0.3}rad ${orbit.phi}rad ${orbit.radius}m`;
  } else if (comando === "reset") {
    viewer.cameraOrbit = `0rad 75deg 3m`;
  }
});
</script>
  </body>
</html>



